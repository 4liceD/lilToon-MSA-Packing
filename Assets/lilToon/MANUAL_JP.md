# マニュアル

# 目次
- [登場する用語](#登場する用語)
- [基本設定](#基本設定)
    - [UV設定](#uv設定)
- [色設定](#色設定)
    - [基本色設定](#基本色設定)
        - [メインカラー](#メインカラー)
        - [メインカラー2nd・3rd](#メインカラー2nd3rd)
    - [影設定](#影設定)
    - [発光設定](#発光設定)
- [ノーマルマップ・光沢設定](#ノーマルマップ光沢設定)
    - [ノーマルマップ設定](#ノーマルマップ設定)
    - [光沢設定](#光沢設定)
        - [反射](#反射)
        - [マットキャップ](#マットキャップ)
        - [リムライト](#リムライト)
- [拡張設定](#拡張設定)
    - [輪郭線設定](#輪郭線設定)
    - [視差マップ](#視差マップ)
    - [距離フェード](#距離フェード)
    - [AudioLink](#audiolink)
    - [ステンシル設定](#ステンシル設定)
    - [レンダリング設定](#レンダリング設定)
    - [テッセレーション](#テッセレーション)
    - [屈折設定](#屈折設定)
    - [ファー設定](#ファー設定)
- [最適化](#最適化)
    - [最適化](#最適化-1)
    - [シェーダー設定](#シェーダー設定)

<br/>

# 登場する用語
|名前|説明|
|-|-|
|マテリアル|ものの見え方を決めるデータです。|
|テクスチャ|画像のことです。ものの色を決めるときなど、様々なことに使われます。|
|UV|テクスチャを貼る位置を決めるデータです。|
|マスク|処理を行う部分を指定するために使われるテクスチャです。|
|ノーマルマップ|表面に凹凸があるように見せかけるテクスチャです。影や光沢の出方に影響します。|
|マットキャップ|光の反射を描き込んだテクスチャです。|
|リムライト|逆光のように光が周り込み、ものの輪郭だけ明るくなるライトです。|
|ステンシル|画面上で行われるマスク表現です。髪の上に眉毛を描画するなどの表現ができます。|

<br/>

# 基本設定
|名前|説明|
|-|-|
|非表示|オンのときはマテリアルが非表示になります。|
|Unlit化|ライティングを無効化します。|
|透過モード|透過設定を変更できます。|
|Cutoff|透明度がこの数値以下になると完全透明になります。|
|Cull Mode (描画面)|指定した面のみ描画します。|
|背面の法線を反転|面が裏側である場合にライティングなどの処理を反転させます。|
|裏面を影にする|面の裏側を強制的に暗くする度合いです。|
|ZWrite|奥行き情報を書き込むかどうか。基本的にオンに設定すれば良いです。|

<br/>

<details><summary>透過モード一覧</summary>

|透過モード|説明|
|-|-|
|不透明|透過を無視します。|
|透明・不透明|透過を利用しますが半透明の描画はできません。|
|半透明|透過を利用します。半透明のオブジェクト同士が重なると片方が見えなくなる場合があります。|
|屈折|[高負荷] 透けている部分が歪んで見えるようになります。|
|屈折ぼかし|[高負荷] 屈折表現に加えすりガラスのようなぼかしも行えます。|
|ファー|[高負荷] 毛のような表現ができます。スポットライトに照らされる環境下では他マテリアルと違う明るさになります。|
|ファー (カットアウト)|[高負荷] 毛のような表現ができます。明るさの問題はありませんが、見た目が荒くなります。|
</details>

<br/>

## UV設定
|Name|Description|
|-|-|
|Tiling|UVのループ数です。|
|Offset|UVのずらし量です。|
|角度|UVの角度です。|
|スクロール|UVの移動速度です。|
|回転速度|UVの回転速度です。|

<br/>

# 色設定
## 基本色設定
### メインカラー
|名前|説明|
|-|-|
|テクスチャ|テクスチャを指定します。右のカラーピッカーで色を決めることもできます。|
|アルファマスクを焼き込み|テクスチャに透明度を指定したマスクを適用できます。|
|色相|色合いです。|
|彩度|色の鮮やかさです。|
|明度|色の明るさです。|
|ガンマ|コントラストを強調します。|
|焼き込み|色調補正したテクスチャを書き出します。|

### メインカラー2nd・3rd
メインカラーの上に色を乗せることができます。画像編集ソフトでいうレイヤー機能です。
|名前|説明|
|-|-|
|テクスチャ|テクスチャを指定します。Gif画像を指定し"Convert Gif"を押すことでアニメーションさせることもできます。|
|MSDFテクスチャ|[MSDFテクスチャ](https://github.com/Chlumsky/msdfgen)としてサンプリングします。ベクター画像に近い表現ができます。|
|デカール化|オンのときはレイヤーをデカールとして利用します。|
|マスク|マスクで指定した部分だけレイヤーを合成できます。|
|ライティングを適用|マットキャップにライトの明るさを適用します。|
|合成モード|レイヤーの合成方法です。通常、加算、スクリーン、乗算が選択できます。|
|焼き込み|レイヤーを1枚のテクスチャに統合します。|

<details><summary>通常時のパラメーター</summary>

|名前|説明|
|-|-|
|Tiling|テクスチャのループ数です。|
|Offset|テクスチャのずらし量です。|
|角度|テクスチャの角度です。|
</details>

<details><summary>デカール時のパラメーター</summary>

|名前|説明|
|-|-|
|ミラーモード|デカールを反転させたり片側だけ表示させたりすることができます。UVが片側しかないもの向けの設定です。|
|複製モード|デカールを反転させたり片側だけ表示させたりすることができます。UVが左右対称のもの向けの設定です。|
|X・Y座標|デカールの位置です。|
|X・Y軸サイズ|デカールの大きさです。|
|角度|デカールの角度です。|
|-|-|
|X・Y軸のフレーム数|それぞれの軸に並べられたコマの枚数です。|
|合計フレーム数|合計の枚数です。|
|FPS|再生速度です。|
|X・Y軸比率|並べられたテクスチャの右や下に空白がある場合に設定する空白の比率です。|
|境界を調整|他のコマが上下左右にはみ出す場合に数値を上げると改善されます。|
</details>

<br/>

## 影設定
|名前|説明|
|-|-|
|AOと影範囲|影になる範囲です。AO(陰影)テクスチャを指定すると暗い部分ほど影が出やすくなります。|
|ぼかし|影のぼかし量です。マスクを指定すると部分的にぼかし量を変更できます。|
|マスクと強度|影の強さです。マスクを指定すると黒く塗った部分に影が出なくなります。|
|影色1・2|影の色です。テクスチャを指定して色を上書きすることもできます。影色2の透明度を上げると影の中に影を追加できます。|
|メインカラーの強度|メインカラーを乗算して影の色を強調することができます。|
|環境光の強さ|周囲の光が影の色に影響する強さです。|
|境界の色|影をぼかした際に境界に色を乗せます。|
|境界の幅|境界の色を乗せる範囲を広くします。|
|影を受け取る|他オブジェクトから影を受け取ります。屋根がある空間で違和感が出ることがあり、オフにしたほうが良い場合が多いです。|

<br/>

## 発光設定
|名前|説明|
|-|-|
|色|発光の色です。横の三角マークからUVを設定できます。|
|マスク|発光させる場所や強さを指定します。横の三角マークからUVを設定できます。|
|点滅の強さ|点滅させる強さです。|
|点滅タイプ|オフではなめらかに、オンでははっきりと点滅します。|
|点滅の速度|点滅の速度です。|
|点滅のズレ|点滅のタイミングをずらします。|
|グラデーション|グラデーションを指定して色を時間変化させることができます。|
|視差の強さ|見る角度に応じてUVをずらします。|
|蛍光|ライトが暗いときのみ光るようになりますが、完全に光のない空間では光りません。暗い部屋で目を明るく見せる場合などにおすすめです。|

<br/>

# ノーマルマップ・光沢設定
## ノーマルマップ設定
|名前|説明|
|-|-|
|ノーマルマップ|ノーマルマップを指定します。|
|マスク|ノーマルマップを適用する部分と強さを指定します。|

<br/>

## 光沢設定
### 反射
|名前|説明|
|-|-|
|滑らかさ|表面の滑らかさです。数値を下げるほど反射が柔らかくなります。|
|金属度|金属っぽさです。|
|色|反射の色です。|
|光沢のタイプ|ライトを反射させる見た目です。|
|環境光の反射|周りの色を反射させます。|

### マットキャップ
|名前|説明|
|-|-|
|マットキャップ|マットキャップを指定します。|
|マスク|マットキャップを適用する部分を指定します。|
|ライティングを適用|マットキャップにライトの明るさを適用します。|
|合成モード|マットキャップの合成方法です。通常、加算、スクリーン、乗算が選択できます。|

### リムライト
|名前|説明|
|-|-|
|色|リムライトの色です。|
|範囲|リムライトで光らせる範囲です。|
|ぼかし|リムライトのぼかし量です。|
|リムライトの細さ|リムライトの細さです。|
|ライティングを適用|リムライトにライトの明るさを適用します。|
|影部分で無効化|影の部分でリムライトを消すようになります。|

<br/>

# 拡張設定
## 輪郭線設定
|名前|説明|
|-|-|
|テクスチャ|テクスチャを指定します。右のカラーピッカーで色を決めることもできます。|
|色相|色合いです。|
|彩度|色の鮮やかさです。|
|明度|色の明るさです。|
|ガンマ|コントラストを強調します。|
|焼き込み|色調補正したテクスチャを書き出します。|
|マスクと太さ|輪郭線の太さです。マスクを指定すると黒く塗った部分に輪郭線が出なくなります。|
|太さを補正|距離による太さの変化を補正します。|
|Vertex R -> Width|頂点カラーのR値を太さに適用します。|
|ライティングを適用|ライティングによる明るさの変化を適用します。|

<br/>

## 視差マップ
|名前|説明|
|-|-|
|視差マップ|視差マップとその強度です。|
|オフセット|視差マップの基準となる値です。|

<br/>

## 距離フェード
|名前|説明|
|-|-|
|色|フェード後の色です。|
|開始距離|フェードを開始する距離です。|
|終了距離|フェードを終了する距離です。|
|強度|フェードの強さです。|

<br/>

## AudioLink
|名前|説明|
|-|-|
|UV Mode|オーディオエフェクトをサンプリングする際に使うUVの種類です。|
|サイズ|UVに応じたタイミングのずらし量です。|
|Offset|タイミングのずらし量です。|
|角度|UVの角度です。|
|帯域|サンプリングする帯域(音の高さ)です。|
|マスク|AudioLinkの処理を変更するマスクテクスチャです。(R:遅延 G:帯域 B:強度)|
|適用先|エフェクトを適用する対象です。|
|-|-|
|ローカル化|AudioLinkからテクスチャを取得せずにローカルのテクスチャを使用します。|
|ローカルマップ|ローカルのテクスチャです。|
|BPM|曲のテンポです。|
|拍数|BPMに掛け合わせる数値です。|
|Offset|タイミングのずらし量です。|

<br/>

## ステンシル設定
複雑で理解が困難な場合、以下のように理解すると問題なく使えます。

    例: 眉毛を髪の上から描画したい場合
    眉毛のマテリアルでSet Writer、髪のマテリアルでSet Readerを押す
    眉毛と髪のRefの数値を合わせる

|名前|説明|
|-|-|
|Ref|ステンシル処理に使われるIDです。IDを元に描画する・しないを決定します。|
|ReadMask|比較前のRefの値に対するマスク処理です。|
|WriteMask|書き込む値に対するマスク処理です。|
|Comp|IDの比較の方法です。この条件を満たすときに描画されます。|
|Pass|描画するときにIDを書き換えるかどうかの設定です。|
|Fail|描画されないときにIDを書き換えるかどうかの設定です。|
|ZFail|手前にものがあって描画されないが、Compの条件を満たす場合にIDを書き換えるかどうかの設定。|
|Set Writer|ステンシルを書き込む側の設定にします。|
|Set Reader|ステンシルを読み込む側の設定にします。|
|Reset|ステンシルの設定を初期化し、ステンシルを行わない状態に戻します。|

<br/>

## レンダリング設定
通常は変更しない複雑な設定項目です。無視して問題ありません。
|名前|説明|
|-|-|
|シェーダーの種類|通常版と軽量版を選択できます。|
|Cull Mode (描画面)|指定した面のみ描画します。|
|ZWrite|奥行き情報を書き込むかどうか。数値は奥ほど大きく、手前ほど小さくなります。|
|ZTest|奥行き情報の比較方法です。この条件を満たすときに描画されます。|
|Offset Factor|画面座標に基づいて奥行き情報を増減させます。|
|Offset Units|奥行き情報を増減させます。|
|SrcBlend|シェーダーで計算された色に乗算する数値。|
|DstBlend|すでに画面にある色に乗算する数値。|
|BlendOp|数値の合成方法。Add以外にするとSrcBlendとDstBlendは無視されます。|
|ForwardAdd*|追加のライトの合成時のみ使われる上記3つの設定です。|
|Enable GPU Instancing|GPU Instancingを行うかどうか。|
|Render Queue|マテリアルを描画する順序を決める際に使われる数値です。大きいほど後に描画されます。|

<br/>

## テッセレーション
近づいた際にモデルをなめらかにする実験的な機能です。ハイポリのモデルでは負荷が非常に高くなるので、ローポリのモデルをなめらかに見せたい場合などに限って使うと良いでしょう。
|名前|説明|
|-|-|
|閾値|この数値以上に辺が長くなったらポリゴンを分割します。|
|強度|なめらかにする処理の強さです。|
|縮小補正|縮小する量です。なめらかにする際にモデルが大きく見えるようになるため、それを補うためのものです。|
|最大分割数|辺の最大分割数です。数値が大きいほど細かく分割されるため、負荷がかかりやすくなります。|

<br/>

## 屈折設定
|名前|説明|
|-|-|
|屈折の強さ|奥にあるものを歪ませる強さです。|
|フレネル|角度に応じた歪みやすさです。|
|メインカラーから色を取得|メインカラーを屈折の色に適用します。|
|色|屈折の色です。|

<br/>

## ファー設定
|名前|説明|
|-|-|
|ノーマルマップ|ここで指定したノーマルマップをファーの向きとして利用できます。|
|向き|ファーの向きです。|
|長さ|ファーの長さです。|
|VertexColor -> Vector|頂点カラーをファーの向きとして利用します。|
|重力|重力によってファーが下を向く強さです。|
|ノイズ|ファーの生成に使われるノイズテクスチャです。|
|Tiling|ノイズの細かさ、つまり毛の細かさです。|
|Offset|ノイズテクスチャのずらし量です。|
|マスク|マスクを指定すると黒く塗った部分でファーが無効化されます。|
|陰影|ファーに陰影を適用する度合いです。|
|レイヤー数|ファーを生成する量です。数値を上げるほど密度が高くなりますが、負荷も高くなります。|

<br/>

# 最適化
## 最適化
|名前|説明|
|-|-|
|全て焼き込み|メインカラーと色調補正、レイヤー2&3を統合して1枚のテクスチャにします。負荷を軽減しつつ他シェーダーに変更した際の見た目の変化を抑えることができます。|
|色調補正を焼き込み|色調補正したテクスチャを書き出します。他シェーダーに変更した際の見た目の変化を抑えることができます。|
|レイヤー2を焼き込み|メインカラーとレイヤー2を1枚のテクスチャに統合します。|
|レイヤー3を焼き込み|メインカラーとレイヤー3を1枚のテクスチャに統合します。|
|未使用のテクスチャを外す|マテリアルから使われていないテクスチャを外します。|
|lilToonLiteに変換|マテリアルを軽量版のlilToonLite用に変換します。|
|MToon(VRM)に変換|マテリアルをVRMで使われるMToon用に変換します。|

<br/>

## シェーダー設定
全マテリアル共通の設定です。ここでオフにした機能はシェーダーから除去されます。不要な機能をオフにすることでアバターの容量を削減しつつ、負荷も抑えることができます。アバターをワールドに設置する場合、「ワールドに配置されているアバター全てに共通の設定が適用される」ためワールド製作者の指定したシェーダー設定に合わせる必要があります。